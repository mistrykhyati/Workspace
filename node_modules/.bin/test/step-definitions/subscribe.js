let {defineSupportCode} = require('cucumber');
//const { AfterStep, Status } = require('cucumber');
//const reporter = require('wdio-allure-reporter');
let chai = require('chai');
global.expect = chai.expect;
chai.should();
var assert = chai.assert;
//const WdioScreenshot = require('wdio-screenshot-v5');

defineSupportCode(function({Given, When, Then}) {
   	 
    Given('I am on Economist page', () => {
	  browser.maximizeWindow();
	   browser.pause(2000);
      browser.url('http://www.economist.com');
	  browser.pause(3000);
	//  browser.saveScreenshot("D:\\webdriverio-test\\node_modules\\screenshot\\error.png")
	  //browser.embed(screenshot, "image/png");
	  
    });
   
	When('I click on Subscribe button', () => {
	 $('=Subscribe').click();			  
		//expect(browser.getTitle()).to.be.eql(title);
		//console.log("test");    
    });
	
	Then('Country is selected as India', () => {
      $("#country-selector").selectByVisibleText("India");
	  var country = $('.Navigation__Select-labelSelected.geo-select').getText().substring(0);	 
	  console.log(country);	  
	  assert.equal(country, 'India');
	 
    });
	
	Then('I verify currency as rupees', () => {
      var rupees = $('.is-bestValue .Offer__briefProp > span').getText().substring(17,19).trim(); 
	  console.log(rupees);
	  assert.equal(rupees, '₹');
    });
	
	When('I select country as Germany', () => {     
	  $("#country-selector").selectByVisibleText("Germany");
	  var germany_as_country = $('.Navigation__Select-labelSelected.geo-select').getText().substring(0);   
	  assert.equal(germany_as_country, 'Germany');
    });
	
	Then('I verify currency as Euro', () => {
      var euro = $('.is-bestValue .Offer__briefProp > span').getText().substring(17,19).trim(); 
	  console.log(euro);
	  assert.equal(euro, '€');
    });
	
	Given('Goto Economist page', () => {
	 browser.maximizeWindow();
	   browser.pause(2000);
      browser.url('http://www.economist.com');
	  browser.pause(3000);
    });
   
	When('I click Subscribe button', () => {
	 $('=Subscribe').click();
	 browser.pause(2000);
	// $('#_evidon-accept-button').click();
    });
	
	Then('I click Subscribe now', () => {
     $('.is-bestValue .Btn--primary').click();	
	 browser.pause(2000);
    });
	
	Then('I click one year plan option', () => {
     $('//div[@id="OfferItems-for-products-505"]/section/div/label[2]/span/span/p').click();		
    });
	
	Then('Click continue to checkout', () => {
      $('//div[@id="OfferItems-for-products-505"]/section/div[2]/input').click();	
	  browser.pause(3000);
    });
	
	When('I enter email address and click on next', () => {	
	 // client.scroll('#username');
	 // var element = 
	 // browser.pause(3000);
	 // browser.scroll('#username');
	  $('#username').setValue('abc@gmail.com');   
	  $('#process-login-button').click();
	  browser.pause(2000);
	  
    });
	
	Then('I verify Good news message', () => {
      var message = $('.Message__item > strong').getAttribute('innerHTML');
	  console.log(message);
	  browser.pause(3000);
	  assert.equal(message, 'Good News!');
    });
	
	
});